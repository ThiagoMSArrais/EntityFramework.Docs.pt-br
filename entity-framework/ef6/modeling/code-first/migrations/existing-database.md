---
title: Migrações do Code First com um banco de dados - EF6
author: divega
ms.date: 2016-10-23
ms.assetid: f0cc4f93-67dd-4664-9753-0a9f913814db
ms.openlocfilehash: 06aabf3f57ca451f4d9cba469f6de40fd9aa8f23
ms.sourcegitcommit: dadee5905ada9ecdbae28363a682950383ce3e10
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 08/27/2018
ms.locfileid: "42998191"
---
# <a name="code-first-migrations-with-an-existing-database"></a><span data-ttu-id="e1245-102">Migrações do Code First com um banco de dados existente</span><span class="sxs-lookup"><span data-stu-id="e1245-102">Code First Migrations with an existing database</span></span>
> [!NOTE]
> <span data-ttu-id="e1245-103">**EF4.3 em diante, somente** -recursos, APIs, etc. discutidos nesta página foram introduzidas no Entity Framework 4.1.</span><span class="sxs-lookup"><span data-stu-id="e1245-103">**EF4.3 Onwards Only** - The features, APIs, etc. discussed in this page were introduced in Entity Framework 4.1.</span></span> <span data-ttu-id="e1245-104">Se você estiver usando uma versão anterior, algumas ou todas as informações não se aplicarão.</span><span class="sxs-lookup"><span data-stu-id="e1245-104">If you are using an earlier version, some or all of the information does not apply.</span></span>

<span data-ttu-id="e1245-105">Este artigo aborda o uso de migrações do Code First com um banco de dados existente, o que não foi criado pelo Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="e1245-105">This article covers using Code First Migrations with an existing database, one that wasn’t created by Entity Framework.</span></span>

> [!NOTE]
> <span data-ttu-id="e1245-106">Este artigo pressupõe que você sabe como usar as migrações Code First em cenários básicos.</span><span class="sxs-lookup"><span data-stu-id="e1245-106">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="e1245-107">Se você não fizer isso, você precisará ler [migrações do Code First](~/ef6/modeling/code-first/migrations/index.md) antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="e1245-107">If you don’t, then you’ll need to read [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) before continuing.</span></span>

## <a name="screencasts"></a><span data-ttu-id="e1245-108">Screencasts</span><span class="sxs-lookup"><span data-stu-id="e1245-108">Screencasts</span></span>

<span data-ttu-id="e1245-109">Se, em vez disso, você teria assistir um screencast que leia este artigo, os vídeos a seguir abrangem o mesmo conteúdo deste artigo.</span><span class="sxs-lookup"><span data-stu-id="e1245-109">If you'd rather watch a screencast than read this article, the following two videos cover the same content as this article.</span></span>

### <a name="video-one-migrations---under-the-hood"></a><span data-ttu-id="e1245-110">Vídeo 1: "Migrações – nos bastidores"</span><span class="sxs-lookup"><span data-stu-id="e1245-110">Video One: "Migrations - Under the Hood"</span></span>

<span data-ttu-id="e1245-111">[Neste screencast](http://channel9.msdn.com/blogs/ef/migrations-under-the-hood) aborda como controla as migrações e usa as informações sobre o modelo para detectar alterações no modelo.</span><span class="sxs-lookup"><span data-stu-id="e1245-111">[This screencast](http://channel9.msdn.com/blogs/ef/migrations-under-the-hood) covers how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="video-two-migrations---existing-databases"></a><span data-ttu-id="e1245-112">Vídeo 2: "Migrações – bancos de dados existentes"</span><span class="sxs-lookup"><span data-stu-id="e1245-112">Video Two: "Migrations - Existing Databases"</span></span>

<span data-ttu-id="e1245-113">Aproveitando os conceitos de vídeo anterior, [este screencast](http://channel9.msdn.com/blogs/ef/migrations-existing-databases) aborda como habilitar e usar as migrações com um banco de dados existente.</span><span class="sxs-lookup"><span data-stu-id="e1245-113">Building on the concepts from the previous video, [this screencast](http://channel9.msdn.com/blogs/ef/migrations-existing-databases) covers how to enable and use migrations with an existing database.</span></span>

## <a name="step-1-create-a-model"></a><span data-ttu-id="e1245-114">Etapa 1: Criar um modelo</span><span class="sxs-lookup"><span data-stu-id="e1245-114">Step 1: Create a model</span></span>

<span data-ttu-id="e1245-115">A primeira etapa será criar um modelo Code First que tem como alvo o banco de dados existente.</span><span class="sxs-lookup"><span data-stu-id="e1245-115">Your first step will be to create a Code First model that targets your existing database.</span></span> <span data-ttu-id="e1245-116">O [Code First para um banco de dados](~/ef6/modeling/code-first/workflows/existing-database.md) tópico fornece orientações detalhadas sobre como fazer isso.</span><span class="sxs-lookup"><span data-stu-id="e1245-116">The [Code First to an Existing Database](~/ef6/modeling/code-first/workflows/existing-database.md) topic provides detailed guidance on how to do this.</span></span>

>[!NOTE]
> <span data-ttu-id="e1245-117">É importante seguir o restante das etapas neste tópico antes de fazer alterações ao seu modelo que exige alterações no esquema de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e1245-117">It is important to follow the rest of the steps in this topic before making any changes to your model that would require changes to the database schema.</span></span> <span data-ttu-id="e1245-118">As etapas a seguir exigem o modelo a ser em sincronia com o esquema de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e1245-118">The following steps require the model to be in-sync with the database schema.</span></span>

## <a name="step-2-enable-migrations"></a><span data-ttu-id="e1245-119">Etapa 2: Habilitar migrações</span><span class="sxs-lookup"><span data-stu-id="e1245-119">Step 2: Enable Migrations</span></span>

<span data-ttu-id="e1245-120">A próxima etapa é permitir migrações.</span><span class="sxs-lookup"><span data-stu-id="e1245-120">The next step is to enable migrations.</span></span> <span data-ttu-id="e1245-121">Você pode fazer isso executando o **Enable-Migrations** comando no Console do Gerenciador de pacotes.</span><span class="sxs-lookup"><span data-stu-id="e1245-121">You can do this by running the **Enable-Migrations** command in Package Manager Console.</span></span>

<span data-ttu-id="e1245-122">Esse comando será criar uma pasta na solução denominada migrações e colocar uma única classe dentro dela chamada de configuração.</span><span class="sxs-lookup"><span data-stu-id="e1245-122">This command will create a folder in your solution called Migrations, and put a single class inside it called Configuration.</span></span> <span data-ttu-id="e1245-123">A classe de configuração é onde você configura as migrações para seu aplicativo, você pode encontrar mais informações sobre ela na [migrações do Code First](~/ef6/modeling/code-first/migrations/index.md) tópico.</span><span class="sxs-lookup"><span data-stu-id="e1245-123">The Configuration class is where you configure migrations for your application, you can find out more about it in the [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) topic.</span></span>

## <a name="step-3-add-an-initial-migration"></a><span data-ttu-id="e1245-124">Etapa 3: Adicionar uma migração inicial</span><span class="sxs-lookup"><span data-stu-id="e1245-124">Step 3: Add an initial migration</span></span>

<span data-ttu-id="e1245-125">Depois que as migrações foram criadas e aplicadas para o banco de dados local, que talvez você queira aplicá-las altera para outros bancos de dados.</span><span class="sxs-lookup"><span data-stu-id="e1245-125">Once migrations have been created and applied to the local database you may also want to apply these changes to other databases.</span></span> <span data-ttu-id="e1245-126">Por exemplo, seu banco de dados local pode ser um banco de dados de teste e, por fim, convém também se aplicam as alterações a um banco de dados de produção e/ou bancos de dados de teste de outros desenvolvedores.</span><span class="sxs-lookup"><span data-stu-id="e1245-126">For example, your local database may be a test database and you may ultimately want to also apply the changes to a production database and/or other developers test databases.</span></span> <span data-ttu-id="e1245-127">Há duas opções para esta etapa e você deve escolher aquele depende se o esquema de outros bancos de dados está vazio ou atualmente correspondem ao esquema de banco de dados local.</span><span class="sxs-lookup"><span data-stu-id="e1245-127">There are two options for this step and the one you should pick depends whether or not the schema of any other databases is empty or currently matches the schema of the local database.</span></span>

-   <span data-ttu-id="e1245-128">**Opção um: Use o esquema existente como ponto de partida.**</span><span class="sxs-lookup"><span data-stu-id="e1245-128">**Option One: Use existing schema as starting point.**</span></span> <span data-ttu-id="e1245-129">Você deve usar essa abordagem quando outros bancos de dados que as migrações serão aplicadas a futuramente terão o mesmo esquema que atualmente tem um banco de dados local.</span><span class="sxs-lookup"><span data-stu-id="e1245-129">You should use this approach when other databases that migrations will be applied to in the future will have the same schema as your local database currently has.</span></span> <span data-ttu-id="e1245-130">Por exemplo, você pode usar isso se seu banco de dados de teste local no momento corresponde v1 do seu banco de dados de produção e mais tarde, você aplicará essas migrações para atualizar seu banco de dados de produção para v2.</span><span class="sxs-lookup"><span data-stu-id="e1245-130">For example, you might use this if your local test database currently matches v1 of your production database and you will later apply these migrations to update your production database to v2.</span></span>
-   <span data-ttu-id="e1245-131">**Opção dois: Use o banco de dados vazio como ponto de partida.**</span><span class="sxs-lookup"><span data-stu-id="e1245-131">**Option Two: Use empty database as starting point.**</span></span> <span data-ttu-id="e1245-132">Você deve usar essa abordagem quando outros bancos de dados que as migrações serão aplicadas a futuramente estão vazios (ou ainda não existir).</span><span class="sxs-lookup"><span data-stu-id="e1245-132">You should use this approach when other databases that migrations will be applied to in the future are empty (or do not exist yet).</span></span> <span data-ttu-id="e1245-133">Por exemplo, você pode usar isso se você iniciar o desenvolvimento de seu aplicativo usando um banco de dados de teste, mas sem usar as migrações e você posteriormente desejará criar um banco de dados de produção do zero.</span><span class="sxs-lookup"><span data-stu-id="e1245-133">For example, you might use this if you started developing your application using a test database but without using migrations and you will later want to create a production database from scratch.</span></span>

### <a name="option-one-use-existing-schema-as-a-starting-point"></a><span data-ttu-id="e1245-134">Opção um: Use o esquema existente como ponto de partida</span><span class="sxs-lookup"><span data-stu-id="e1245-134">Option One: Use existing schema as a starting point</span></span>

<span data-ttu-id="e1245-135">Migrações do Code First usa um instantâneo do modelo armazenado na migração mais recente para detectar as alterações no modelo (você pode encontrar informações detalhadas sobre isso em [migrações do Code First em ambientes de equipe](~/ef6/modeling/code-first/migrations/teams.md)).</span><span class="sxs-lookup"><span data-stu-id="e1245-135">Code First Migrations uses a snapshot of the model stored in the most recent migration to detect changes to the model (you can find detailed information about this in [Code First Migrations in Team Environments](~/ef6/modeling/code-first/migrations/teams.md)).</span></span> <span data-ttu-id="e1245-136">Já que vamos supor que os bancos de dados já tem o esquema do modelo atual, geramos uma migração (sem op) vazia que tem o modelo atual como um instantâneo.</span><span class="sxs-lookup"><span data-stu-id="e1245-136">Since we are going to assume that databases already have the schema of the current model, we will generate an empty (no-op) migration that has the current model as a snapshot.</span></span>

1.  <span data-ttu-id="e1245-137">Execute o **Add-Migration InitialCreate – IgnoreChanges** comando no Console do Gerenciador de pacotes.</span><span class="sxs-lookup"><span data-stu-id="e1245-137">Run the **Add-Migration InitialCreate –IgnoreChanges** command in Package Manager Console.</span></span> <span data-ttu-id="e1245-138">Isso cria uma migração vazia com o modelo atual como um instantâneo.</span><span class="sxs-lookup"><span data-stu-id="e1245-138">This creates an empty migration with the current model as a snapshot.</span></span>
2.  <span data-ttu-id="e1245-139">Execute o **Update-Database** comando no Console do Gerenciador de pacotes.</span><span class="sxs-lookup"><span data-stu-id="e1245-139">Run the **Update-Database** command in Package Manager Console.</span></span> <span data-ttu-id="e1245-140">Isso se aplicará a migração InitialCreate ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e1245-140">This will apply the InitialCreate migration to the database.</span></span> <span data-ttu-id="e1245-141">Uma vez que a migração real não contém todas as alterações, ele simplesmente adicionará uma linha para o \_ \_MigrationsHistory tabela que indica se essa migração já foi aplicada.</span><span class="sxs-lookup"><span data-stu-id="e1245-141">Since the actual migration doesn’t contain any changes, it will simply add a row to the \_\_MigrationsHistory table indicating that this migration has already been applied.</span></span>

### <a name="option-two-use-empty-database-as-a-starting-point"></a><span data-ttu-id="e1245-142">Opção dois: Usar o banco de dados vazio como um ponto de partida</span><span class="sxs-lookup"><span data-stu-id="e1245-142">Option Two: Use empty database as a starting point</span></span>

<span data-ttu-id="e1245-143">Nesse cenário, precisamos migrações para poder criar o banco de dados inteiro do zero – incluindo as tabelas que já estão presentes no nosso banco de dados local.</span><span class="sxs-lookup"><span data-stu-id="e1245-143">In this scenario we need Migrations to be able to create the entire database from scratch – including the tables that are already present in our local database.</span></span> <span data-ttu-id="e1245-144">Vamos gerar uma migração InitialCreate que inclui lógica para criar o esquema existente.</span><span class="sxs-lookup"><span data-stu-id="e1245-144">We’re going to generate an InitialCreate migration that includes logic to create the existing schema.</span></span> <span data-ttu-id="e1245-145">Em seguida, faremos nosso banco de dados existente parecer que essa migração já foi aplicada.</span><span class="sxs-lookup"><span data-stu-id="e1245-145">We’ll then make our existing database look like this migration has already been applied.</span></span>

1.  <span data-ttu-id="e1245-146">Execute o **Add-Migration InitialCreate** comando no Console do Gerenciador de pacotes.</span><span class="sxs-lookup"><span data-stu-id="e1245-146">Run the **Add-Migration InitialCreate** command in Package Manager Console.</span></span> <span data-ttu-id="e1245-147">Isso cria uma migração para criar o esquema existente.</span><span class="sxs-lookup"><span data-stu-id="e1245-147">This creates a migration to create the existing schema.</span></span>
2.  <span data-ttu-id="e1245-148">Comente todo o código no método de cima da migração recém-criado.</span><span class="sxs-lookup"><span data-stu-id="e1245-148">Comment out all code in the Up method of the newly created migration.</span></span> <span data-ttu-id="e1245-149">Isso nos permitirá ' Aplicar ' a migração para o banco de dados local sem tentar recriar todas as tabelas etc. que já existem.</span><span class="sxs-lookup"><span data-stu-id="e1245-149">This will allow us to ‘apply’ the migration to the local database without trying to recreate all the tables etc. that already exist.</span></span>
3.  <span data-ttu-id="e1245-150">Execute o **Update-Database** comando no Console do Gerenciador de pacotes.</span><span class="sxs-lookup"><span data-stu-id="e1245-150">Run the **Update-Database** command in Package Manager Console.</span></span> <span data-ttu-id="e1245-151">Isso se aplicará a migração InitialCreate ao banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e1245-151">This will apply the InitialCreate migration to the database.</span></span> <span data-ttu-id="e1245-152">Como a migração real não contém todas as alterações (porque estamos temporariamente comentado-out), ele simplesmente adicionará uma linha para o \_ \_MigrationsHistory tabela que indica se essa migração já foi aplicada.</span><span class="sxs-lookup"><span data-stu-id="e1245-152">Since the actual migration doesn’t contain any changes (because we temporarily commented them out), it will simply add a row to the \_\_MigrationsHistory table indicating that this migration has already been applied.</span></span>
4.  <span data-ttu-id="e1245-153">Cancelar os comentários de código no método Up.</span><span class="sxs-lookup"><span data-stu-id="e1245-153">Un-comment the code in the Up method.</span></span> <span data-ttu-id="e1245-154">Isso significa que, quando essa migração é aplicada a bancos de dados futuros, o esquema que já existia no banco de dados local será criado pelas migrações.</span><span class="sxs-lookup"><span data-stu-id="e1245-154">This means that when this migration is applied to future databases, the schema that already existed in the local database will be created by migrations.</span></span>

## <a name="things-to-be-aware-of"></a><span data-ttu-id="e1245-155">Coisas a serem consideradas</span><span class="sxs-lookup"><span data-stu-id="e1245-155">Things to be aware of</span></span>

<span data-ttu-id="e1245-156">Há algumas coisas que você precisa estar ciente ao usar as migrações em relação a um banco de dados existente.</span><span class="sxs-lookup"><span data-stu-id="e1245-156">There are a few things you need to be aware of when using Migrations against an existing database.</span></span>

### <a name="defaultcalculated-names-may-not-match-existing-schema"></a><span data-ttu-id="e1245-157">Os nomes padrão/calculado podem não corresponder ao esquema existente</span><span class="sxs-lookup"><span data-stu-id="e1245-157">Default/calculated names may not match existing schema</span></span>

<span data-ttu-id="e1245-158">Migrações especifica explicitamente os nomes das colunas e tabelas quando ele usa o Scaffold de migrações.</span><span class="sxs-lookup"><span data-stu-id="e1245-158">Migrations explicitly specifies names for columns and tables when it scaffolds a migrations.</span></span> <span data-ttu-id="e1245-159">No entanto, há outros objetos de banco de dados que as migrações calcula um nome padrão para ao aplicar as migrações.</span><span class="sxs-lookup"><span data-stu-id="e1245-159">However, there are other database objects that Migrations calculates a default name for when applying the migrations.</span></span> <span data-ttu-id="e1245-160">Isso inclui índices e restrições de chave estrangeira.</span><span class="sxs-lookup"><span data-stu-id="e1245-160">This includes indexes and foreign key constraints.</span></span> <span data-ttu-id="e1245-161">Ao direcionar um esquema existente, esses nomes calculados podem não corresponder ao que realmente existe em seu banco de dados.</span><span class="sxs-lookup"><span data-stu-id="e1245-161">When targeting an existing schema, these calculated names may not match what actually exists in your database.</span></span>

<span data-ttu-id="e1245-162">Aqui estão alguns exemplos de quando você precisa estar atento isso:</span><span class="sxs-lookup"><span data-stu-id="e1245-162">Here are some examples of when you need to be aware of this:</span></span>

<span data-ttu-id="e1245-163">**Se você usou ' uma opção: usar o esquema existente como um ponto de partida ' da etapa 3:**</span><span class="sxs-lookup"><span data-stu-id="e1245-163">**If you used ‘Option One: Use existing schema as a starting point’ from Step 3:**</span></span>

-   <span data-ttu-id="e1245-164">Se precisam de alterações futuras em seu modelo alterando ou removendo um dos objetos de banco de dados que é chamado de forma diferente, você precisará modificar a migração gerado por scaffolding para especificar o nome correto.</span><span class="sxs-lookup"><span data-stu-id="e1245-164">If future changes in your model require changing or dropping one of the database objects that is named differently, you will need to modify the scaffolded migration to specify the correct name.</span></span> <span data-ttu-id="e1245-165">As APIs de migrações têm um parâmetro de nome opcional que permite que você faça isso.</span><span class="sxs-lookup"><span data-stu-id="e1245-165">The Migrations APIs have an optional Name parameter that allows you to do this.</span></span>
    <span data-ttu-id="e1245-166">Por exemplo, o esquema existente pode ter uma tabela de Post com uma coluna de chave estrangeira BlogId que tem um índice chamado IndexFk\_BlogId.</span><span class="sxs-lookup"><span data-stu-id="e1245-166">For example, your existing schema may have a Post table with a BlogId foreign key column that has an index named IndexFk\_BlogId.</span></span> <span data-ttu-id="e1245-167">No entanto, por padrão as migrações esperaria esse índice seja nomeado IX\_BlogId.</span><span class="sxs-lookup"><span data-stu-id="e1245-167">However, by default Migrations would expect this index to be named IX\_BlogId.</span></span> <span data-ttu-id="e1245-168">Se você fizer uma alteração em seu modelo que resulta em remoção desse índice, você precisará modificar a chamada DropIndex gerado por scaffolding para especificar o IndexFk\_nome BlogId.</span><span class="sxs-lookup"><span data-stu-id="e1245-168">If you make a change to your model that results in dropping this index, you will need to modify the scaffolded DropIndex call to specify the IndexFk\_BlogId name.</span></span>

<span data-ttu-id="e1245-169">**Se você usou ' opção dois: usar o banco de dados vazio como um ponto de partida ' da etapa 3:**</span><span class="sxs-lookup"><span data-stu-id="e1245-169">**If you used ‘Option Two: Use empty database as a starting point’ from Step 3:**</span></span>

-   <span data-ttu-id="e1245-170">Tentativa de executar o método de busca da migração inicial (isto é, reverter para um banco de dados vazio) no banco de dados local pode falhar porque as migrações tentará descartar índices e restrições de chave estrangeira usando os nomes incorretos.</span><span class="sxs-lookup"><span data-stu-id="e1245-170">Trying to run the Down method of the initial migration (that is, reverting to an empty database) against your local database may fail because Migrations will try to drop indexes and foreign key constraints using the incorrect names.</span></span> <span data-ttu-id="e1245-171">Isso afetará apenas o banco de dados local, pois outros bancos de dados serão criados do zero usando o método de cima da migração inicial.</span><span class="sxs-lookup"><span data-stu-id="e1245-171">This will only affect your local database since other databases will be created from scratch using the Up method of the initial migration.</span></span>
    <span data-ttu-id="e1245-172">Se você quiser fazer o downgrade de seu banco de dados local existente para um estado vazio é mais fácil de fazer isso manualmente, por descartar o banco de dados ou descartar todas as tabelas.</span><span class="sxs-lookup"><span data-stu-id="e1245-172">If you want to downgrade your existing local database to an empty state it is easiest to do this manually, either by dropping the database or dropping all the tables.</span></span> <span data-ttu-id="e1245-173">Após esse downgrade inicial de todos os objetos de banco de dados serão recriados com os nomes padrão, portanto, esse problema não apresentará novamente.</span><span class="sxs-lookup"><span data-stu-id="e1245-173">After this initial downgrade all database objects will be recreated with the default names, so this issue will not present itself again.</span></span>
-   <span data-ttu-id="e1245-174">Se precisam de alterações futuras em seu modelo alterando ou removendo um dos objetos de banco de dados que é chamado de forma diferente, isso não funcionará em relação a seu banco de dados local existente – desde que os nomes não coincidem com os padrões.</span><span class="sxs-lookup"><span data-stu-id="e1245-174">If future changes in your model require changing or dropping one of the database objects that is named differently, this will not work against your existing local database – since the names won’t match the defaults.</span></span> <span data-ttu-id="e1245-175">No entanto, ele funcionará em bancos de dados que foram criados 'a partir do zero', pois eles serão usados os nomes padrão escolhidos pelo migrações.</span><span class="sxs-lookup"><span data-stu-id="e1245-175">However, it will work against databases that were created ‘from scratch’ since they will have used the default names chosen by Migrations.</span></span>
    <span data-ttu-id="e1245-176">Você pode fazer essas alterações manualmente no seu banco de dados local existente, ou faça com que as migrações de recriar o banco de dados a partir do zero – quanto em outros computadores.</span><span class="sxs-lookup"><span data-stu-id="e1245-176">You could either make these changes manually on your local existing database, or consider having Migrations recreate your database from scratch – as it will on other machines.</span></span>
-   <span data-ttu-id="e1245-177">Bancos de dados criados usando o método de backup de sua migração inicial podem diferir ligeiramente do banco de dados local, desde os nomes padrão calculado para índices e restrições de chave estrangeira serão usadas.</span><span class="sxs-lookup"><span data-stu-id="e1245-177">Databases created using the Up method of your initial migration may differ slightly from the local database since the calculated default names for indexes and foreign key constraints will be used.</span></span> <span data-ttu-id="e1245-178">Você também poderá terminar com índices adicionais como migrações criará índices em colunas de chave estrangeira por padrão – isso pode não ter sido o caso no seu banco de dados local original.</span><span class="sxs-lookup"><span data-stu-id="e1245-178">You may also end up with extra indexes as Migrations will create indexes on foreign key columns by default – this may not have been the case in your original local database.</span></span>

### <a name="not-all-database-objects-are-represented-in-the-model"></a><span data-ttu-id="e1245-179">Nem todos os objetos de banco de dados são representados no modelo</span><span class="sxs-lookup"><span data-stu-id="e1245-179">Not all database objects are represented in the model</span></span>

<span data-ttu-id="e1245-180">Objetos de banco de dados que não fazem parte do seu modelo não serão manipulados por migrações.</span><span class="sxs-lookup"><span data-stu-id="e1245-180">Database objects that are not part of your model will not be handled by Migrations.</span></span> <span data-ttu-id="e1245-181">Isso pode incluir exibições, procedimentos armazenados, permissões, tabelas que não fazem parte de seu modelo, índices adicionais, etc.</span><span class="sxs-lookup"><span data-stu-id="e1245-181">This can include views, stored procedures, permissions, tables that are not part of your model, additional indexes, etc.</span></span>

<span data-ttu-id="e1245-182">Aqui estão alguns exemplos de quando você precisa estar atento isso:</span><span class="sxs-lookup"><span data-stu-id="e1245-182">Here are some examples of when you need to be aware of this:</span></span>

-   <span data-ttu-id="e1245-183">Independentemente da opção escolhida na etapa 3 se precisam de alterações futuras em seu modelo, alterar ou descartar esses objetos adicionais que as migrações não saberá para fazer essas alterações.</span><span class="sxs-lookup"><span data-stu-id="e1245-183">Regardless of the option you chose in ‘Step 3’, if future changes in your model require changing or dropping these additional objects Migrations will not know to make these changes.</span></span> <span data-ttu-id="e1245-184">Por exemplo, se você descartar uma coluna que tem um índice adicional nele, as migrações não saberá para descartar o índice.</span><span class="sxs-lookup"><span data-stu-id="e1245-184">For example, if you drop a column that has an additional index on it, Migrations will not know to drop the index.</span></span> <span data-ttu-id="e1245-185">Você precisará adicionar isso manualmente para a migração gerado por scaffolding.</span><span class="sxs-lookup"><span data-stu-id="e1245-185">You will need to manually add this to the scaffolded Migration.</span></span>
-   <span data-ttu-id="e1245-186">Se você usou ' opção dois: usar o banco de dados vazio como um ponto de partida ', estes objetos adicionais não serão criados pelo método de cima da sua migração inicial.</span><span class="sxs-lookup"><span data-stu-id="e1245-186">If you used ‘Option Two: Use empty database as a starting point’, these additional objects will not be created by the Up method of your initial migration.</span></span>
    <span data-ttu-id="e1245-187">Você pode modificar cima e para baixo de métodos para cuidar desses objetos adicionais se desejar.</span><span class="sxs-lookup"><span data-stu-id="e1245-187">You can modify the Up and Down methods to take care of these additional objects if you wish.</span></span> <span data-ttu-id="e1245-188">Para objetos que não são suportados nativamente na API de migrações – como modos de exibição – você pode usar o [Sql](https://msdn.microsoft.com/library/system.data.entity.migrations.dbmigration.sql.aspx) método para executar o SQL bruto para criar/remover eles.</span><span class="sxs-lookup"><span data-stu-id="e1245-188">For objects that are not natively supported in the Migrations API – such as views – you can use the [Sql](https://msdn.microsoft.com/library/system.data.entity.migrations.dbmigration.sql.aspx) method to run raw SQL to create/drop them.</span></span>
